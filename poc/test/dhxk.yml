name: cookie测试
manual: true
transport: http
set:
  var1: base64('abc')
  var2: md5('123456')
rules:
  get1:
    request:
      cache: true
      method: GET
      path: /login/index
      headers:
        user-agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36'
        Content-Type: application/json
        token: qmteseteaajfdfjkdjfk
    expression: response.status == 200
    output:
      cookie: base64(response.headers["Set-Cookie"])
  get2:
    request:
      cache: true
      method: GET
      path: /login/index?var1={{var2}}&&var2={{var2}}&&cookie={{cookie}}
      headers:
        user-agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36'
        tst: '{{var1}}'
    expression: response.status == 200
    output:
      search: '"<title>(?P<title>.+?)</title>".bsubmatch(response.body)'
      access_code: response.headers["Content-Type"]
expression: get1() && get2()
detail:
  author: Hzllaga
  links:
    - https://github.com/th3gundy/CVE-2019-7192_QNAP_Exploit
